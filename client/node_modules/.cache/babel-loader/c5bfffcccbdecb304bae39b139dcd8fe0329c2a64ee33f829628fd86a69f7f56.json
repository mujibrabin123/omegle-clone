{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mujib\\\\omegle-clone\\\\client\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport io from \"socket.io-client\";\nimport SimplePeer from \"simple-peer\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./App.css\";\n\n// Use your server URL.\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst socket = io(\"https://server-crimson-wildflower-4430.fly.dev\");\nfunction App() {\n  _s();\n  const [partnerId, setPartnerId] = useState(null);\n  const [searching, setSearching] = useState(false);\n  const [interests, setInterests] = useState(\"\");\n  const [commonInterests, setCommonInterests] = useState([]);\n  const [stream, setStream] = useState(null);\n  const [partnerStream, setPartnerStream] = useState(null);\n  const [myId, setMyId] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  // State for toggling chat overlay on mobile\n  const [showChat, setShowChat] = useState(false);\n  // State for camera facing: \"user\" (front) or \"environment\" (back)\n  const [cameraFacing, setCameraFacing] = useState(\"user\");\n  // State to show a loading indicator when waiting for the remote video\n  const [videoLoading, setVideoLoading] = useState(false);\n  // Ref to skip disconnect alert if Next is triggered\n  const skipDisconnectAlertRef = useRef(false);\n  const userVideo = useRef();\n  const partnerVideo = useRef();\n  const peerRef = useRef(null);\n  // Ref to store the local video sender for track replacement\n  const videoSenderRef = useRef(null);\n\n  // Set the --vh variable for dynamic viewport height\n  useEffect(() => {\n    const setVh = () => {\n      const vh = window.innerHeight * 0.01;\n      document.documentElement.style.setProperty('--vh', `${vh}px`);\n    };\n    setVh();\n    window.addEventListener(\"resize\", setVh);\n    return () => window.removeEventListener(\"resize\", setVh);\n  }, []);\n  useEffect(() => {\n    socket.on(\"connect\", () => {\n      console.log(\"Connected with ID:\", socket.id);\n      setMyId(socket.id);\n    });\n    socket.on(\"partnerFound\", ({\n      partnerId,\n      commonInterests\n    }) => {\n      console.log(\"Partner found:\", partnerId, commonInterests);\n      setPartnerId(partnerId);\n      setCommonInterests(commonInterests);\n      setSearching(false);\n      // Start loading indicator until remote stream arrives\n      setVideoLoading(true);\n    });\n    socket.on(\"signal\", ({\n      signal\n    }) => {\n      console.log(\"Signal received:\", signal);\n      if (peerRef.current) {\n        peerRef.current.signal(signal);\n      }\n    });\n    socket.on(\"partnerDisconnected\", () => {\n      console.log(\"Partner disconnected\");\n      if (skipDisconnectAlertRef.current) {\n        skipDisconnectAlertRef.current = false;\n      } else {\n        alert(\"Your chat partner has disconnected.\");\n      }\n      cleanupCall();\n      findPartner();\n    });\n    socket.on(\"receiveMessage\", message => {\n      console.log(\"Message received:\", message);\n      setMessages(prev => [...prev, {\n        sender: \"partner\",\n        text: message\n      }]);\n    });\n    return () => {\n      socket.off(\"connect\");\n      socket.off(\"partnerFound\");\n      socket.off(\"signal\");\n      socket.off(\"partnerDisconnected\");\n      socket.off(\"receiveMessage\");\n    };\n  }, []);\n  useEffect(() => {\n    if (partnerId && myId && !peerRef.current) {\n      const initiator = myId < partnerId;\n      console.log(\"Starting video chat. Initiator:\", initiator);\n      startVideoChat(initiator);\n    }\n  }, [partnerId, myId, cameraFacing]);\n  const findPartner = () => {\n    setSearching(true);\n    const interestList = interests.trim() ? interests.split(\",\").map(i => i.trim().toLowerCase()) : [];\n    console.log(\"Finding partner with interests:\", interestList);\n    socket.emit(\"findPartner\", interestList);\n  };\n  const startVideoChat = async initiator => {\n    try {\n      const localStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: cameraFacing\n        },\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          sampleRate: 48000,\n          channelCount: 2\n        }\n      });\n      setStream(localStream);\n      if (userVideo.current) {\n        userVideo.current.srcObject = localStream;\n        // Show local video in normal (non-mirrored) mode.\n        userVideo.current.style.transform = \"scaleX(1)\";\n        userVideo.current.muted = true;\n      }\n      const peer = new SimplePeer({\n        initiator,\n        trickle: false,\n        stream: localStream,\n        config: {\n          iceServers: [{\n            urls: \"stun:stun.l.google.com:19302\"\n          }, {\n            urls: \"turn:35.232.251.11:3478?transport=udp\",\n            username: \"mujib.rabin\",\n            credential: \"rabin\"\n          }]\n        }\n      });\n      peer.on(\"signal\", signal => {\n        console.log(\"Sending signal:\", signal);\n        socket.emit(\"signal\", {\n          partnerId,\n          signal\n        });\n      });\n      peer.on(\"stream\", remoteStream => {\n        console.log(\"Remote stream received. Audio tracks:\", remoteStream.getAudioTracks().length);\n        setPartnerStream(remoteStream);\n        if (partnerVideo.current) {\n          partnerVideo.current.srcObject = remoteStream;\n          partnerVideo.current.muted = false;\n          partnerVideo.current.volume = 1.0;\n          partnerVideo.current.onloadedmetadata = () => {\n            partnerVideo.current.play().catch(err => console.error(\"Error playing remote stream:\", err));\n            // Hide loading indicator when remote video is ready\n            setVideoLoading(false);\n          };\n        }\n      });\n      peer.on(\"connect\", () => {\n        console.log(\"Peer connected!\");\n        const videoSender = peer._pc.getSenders().find(s => s.track && s.track.kind === \"video\");\n        videoSenderRef.current = videoSender || null;\n      });\n      peer.on(\"error\", err => console.error(\"Peer error:\", err));\n      peer.on(\"iceStateChange\", state => console.log(\"ICE state:\", state));\n      peerRef.current = peer;\n    } catch (err) {\n      console.error(\"Error accessing media devices:\", err);\n    }\n  };\n\n  // Replace the local video track without restarting the call\n  const replaceLocalTrack = async () => {\n    if (!peerRef.current) return;\n    const newStream = await navigator.mediaDevices.getUserMedia({\n      video: {\n        facingMode: cameraFacing\n      },\n      audio: false\n    });\n    const newVideoTrack = newStream.getVideoTracks()[0];\n    if (videoSenderRef.current && newVideoTrack) {\n      await videoSenderRef.current.replaceTrack(newVideoTrack);\n      if (userVideo.current) {\n        userVideo.current.srcObject = newStream;\n        userVideo.current.style.transform = \"scaleX(1)\";\n        userVideo.current.muted = true;\n      }\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n      }\n      setStream(newStream);\n    }\n  };\n  const cleanupCall = () => {\n    setPartnerId(null);\n    setCommonInterests([]);\n    setPartnerStream(null);\n    setMessages([]);\n    setNewMessage(\"\");\n    if (peerRef.current) {\n      peerRef.current.destroy();\n      peerRef.current = null;\n    }\n    videoSenderRef.current = null;\n    if (stream) {\n      stream.getTracks().forEach(track => track.stop());\n    }\n    setStream(null);\n  };\n  const sendMessage = () => {\n    if (newMessage.trim() === \"\") return;\n    socket.emit(\"sendMessage\", newMessage);\n    setMessages(prev => [...prev, {\n      sender: \"you\",\n      text: newMessage\n    }]);\n    setNewMessage(\"\");\n  };\n  const nextPartner = () => {\n    skipDisconnectAlertRef.current = true;\n    cleanupCall();\n    socket.emit(\"nextPartner\");\n    findPartner();\n  };\n  const toggleCamera = async () => {\n    const newFacing = cameraFacing === \"user\" ? \"environment\" : \"user\";\n    setCameraFacing(newFacing);\n    if (peerRef.current) {\n      await replaceLocalTrack();\n    } else {\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n      }\n      await startVideoChat(true);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `app-wrapper ${partnerId ? \"video-active\" : \"no-partner\"}`,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sidebar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"branding\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"TALKVEE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Connect based on interests\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar-content\",\n        children: [!partnerId && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"partner-search\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: interests,\n            onChange: e => setInterests(e.target.value),\n            onKeyDown: e => {\n              if (e.key === \"Enter\") {\n                findPartner();\n              }\n            },\n            placeholder: \"Enter interests (optional)\",\n            className: \"form-control\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: findPartner,\n            disabled: searching,\n            className: \"btn btn-primary mt-3\",\n            children: searching ? \"Searching...\" : \"Find a Partner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 13\n        }, this), partnerId && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-box\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-messages\",\n            children: messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `chat-message ${msg.sender === \"you\" ? \"sent\" : \"received\"}`,\n              children: msg.text\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-input\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: newMessage,\n              onChange: e => setNewMessage(e.target.value),\n              onKeyDown: e => {\n                if (e.key === \"Enter\") {\n                  sendMessage();\n                }\n              },\n              placeholder: \"Type a message...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: sendMessage,\n              className: \"btn btn-outline-light\",\n              children: \"Send\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 296,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-content\",\n      children: partnerId ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-container\",\n          children: [videoLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-overlay\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                color: \"#fff\",\n                fontSize: \"1.5rem\"\n              },\n              children: \"Loading...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: partnerVideo,\n            autoPlay: true,\n            playsInline: true,\n            className: \"partner-video\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: userVideo,\n            autoPlay: true,\n            playsInline: true,\n            className: \"user-video-overlay\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"common-interests\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Common Interests:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: commonInterests.length > 0 ? commonInterests.join(\", \") : \"None\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"control-buttons-bottom\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => window.location.reload(),\n            className: \"btn btn-danger btn-lg\",\n            children: \"Disconnect\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: nextPartner,\n            className: \"btn btn-warning btn-lg\",\n            children: \"Next\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"switch-camera\",\n          onClick: toggleCamera,\n          children: \"\\u21BB\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"chat-toggle\",\n          onClick: () => setShowChat(prev => !prev),\n          children: showChat ? \"Hide Chat\" : \"Show Chat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `chat-overlay ${showChat ? \"active\" : \"\"}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-messages\",\n            children: messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `chat-message ${msg.sender === \"you\" ? \"sent\" : \"received\"}`,\n              children: msg.text\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-input\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: newMessage,\n              onChange: e => setNewMessage(e.target.value),\n              onKeyDown: e => {\n                if (e.key === \"Enter\") {\n                  sendMessage();\n                }\n              },\n              placeholder: \"Type a message...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: sendMessage,\n              children: \"Send\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"welcome-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Welcome to TALKVEE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"MAY CONTAIN WEIRD BUT FUN PEOPLE.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 244,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"6Hq29ZRqTNvL4BaFGGYWbJZzMLI=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","io","SimplePeer","jsxDEV","_jsxDEV","Fragment","_Fragment","socket","App","_s","partnerId","setPartnerId","searching","setSearching","interests","setInterests","commonInterests","setCommonInterests","stream","setStream","partnerStream","setPartnerStream","myId","setMyId","messages","setMessages","newMessage","setNewMessage","showChat","setShowChat","cameraFacing","setCameraFacing","videoLoading","setVideoLoading","skipDisconnectAlertRef","userVideo","partnerVideo","peerRef","videoSenderRef","setVh","vh","window","innerHeight","document","documentElement","style","setProperty","addEventListener","removeEventListener","on","console","log","id","signal","current","alert","cleanupCall","findPartner","message","prev","sender","text","off","initiator","startVideoChat","interestList","trim","split","map","i","toLowerCase","emit","localStream","navigator","mediaDevices","getUserMedia","video","facingMode","audio","echoCancellation","noiseSuppression","autoGainControl","sampleRate","channelCount","srcObject","transform","muted","peer","trickle","config","iceServers","urls","username","credential","remoteStream","getAudioTracks","length","volume","onloadedmetadata","play","catch","err","error","videoSender","_pc","getSenders","find","s","track","kind","state","replaceLocalTrack","newStream","newVideoTrack","getVideoTracks","replaceTrack","getTracks","forEach","stop","destroy","sendMessage","nextPartner","toggleCamera","newFacing","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","value","onChange","e","target","onKeyDown","key","placeholder","onClick","disabled","msg","index","color","fontSize","ref","autoPlay","playsInline","join","location","reload","_c","$RefreshReg$"],"sources":["C:/Users/mujib/omegle-clone/client/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport io from \"socket.io-client\";\nimport SimplePeer from \"simple-peer\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./App.css\";\n\n// Use your server URL.\nconst socket = io(\"https://server-crimson-wildflower-4430.fly.dev\");\n\nfunction App() {\n  const [partnerId, setPartnerId] = useState(null);\n  const [searching, setSearching] = useState(false);\n  const [interests, setInterests] = useState(\"\");\n  const [commonInterests, setCommonInterests] = useState([]);\n  const [stream, setStream] = useState(null);\n  const [partnerStream, setPartnerStream] = useState(null);\n  const [myId, setMyId] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  // State for toggling chat overlay on mobile\n  const [showChat, setShowChat] = useState(false);\n  // State for camera facing: \"user\" (front) or \"environment\" (back)\n  const [cameraFacing, setCameraFacing] = useState(\"user\");\n  // State to show a loading indicator when waiting for the remote video\n  const [videoLoading, setVideoLoading] = useState(false);\n  // Ref to skip disconnect alert if Next is triggered\n  const skipDisconnectAlertRef = useRef(false);\n\n  const userVideo = useRef();\n  const partnerVideo = useRef();\n  const peerRef = useRef(null);\n  // Ref to store the local video sender for track replacement\n  const videoSenderRef = useRef(null);\n\n  // Set the --vh variable for dynamic viewport height\n  useEffect(() => {\n    const setVh = () => {\n      const vh = window.innerHeight * 0.01;\n      document.documentElement.style.setProperty('--vh', `${vh}px`);\n    };\n    setVh();\n    window.addEventListener(\"resize\", setVh);\n    return () => window.removeEventListener(\"resize\", setVh);\n  }, []);\n\n  useEffect(() => {\n    socket.on(\"connect\", () => {\n      console.log(\"Connected with ID:\", socket.id);\n      setMyId(socket.id);\n    });\n\n    socket.on(\"partnerFound\", ({ partnerId, commonInterests }) => {\n      console.log(\"Partner found:\", partnerId, commonInterests);\n      setPartnerId(partnerId);\n      setCommonInterests(commonInterests);\n      setSearching(false);\n      // Start loading indicator until remote stream arrives\n      setVideoLoading(true);\n    });\n\n    socket.on(\"signal\", ({ signal }) => {\n      console.log(\"Signal received:\", signal);\n      if (peerRef.current) {\n        peerRef.current.signal(signal);\n      }\n    });\n\n    socket.on(\"partnerDisconnected\", () => {\n      console.log(\"Partner disconnected\");\n      if (skipDisconnectAlertRef.current) {\n        skipDisconnectAlertRef.current = false;\n      } else {\n        alert(\"Your chat partner has disconnected.\");\n      }\n      cleanupCall();\n      findPartner();\n    });\n\n    socket.on(\"receiveMessage\", (message) => {\n      console.log(\"Message received:\", message);\n      setMessages((prev) => [...prev, { sender: \"partner\", text: message }]);\n    });\n\n    return () => {\n      socket.off(\"connect\");\n      socket.off(\"partnerFound\");\n      socket.off(\"signal\");\n      socket.off(\"partnerDisconnected\");\n      socket.off(\"receiveMessage\");\n    };\n  }, []);\n\n  useEffect(() => {\n    if (partnerId && myId && !peerRef.current) {\n      const initiator = myId < partnerId;\n      console.log(\"Starting video chat. Initiator:\", initiator);\n      startVideoChat(initiator);\n    }\n  }, [partnerId, myId, cameraFacing]);\n\n  const findPartner = () => {\n    setSearching(true);\n    const interestList = interests.trim()\n      ? interests.split(\",\").map((i) => i.trim().toLowerCase())\n      : [];\n    console.log(\"Finding partner with interests:\", interestList);\n    socket.emit(\"findPartner\", interestList);\n  };\n\n  const startVideoChat = async (initiator) => {\n    try {\n      const localStream = await navigator.mediaDevices.getUserMedia({\n        video: { facingMode: cameraFacing },\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          sampleRate: 48000,\n          channelCount: 2,\n        },\n      });\n      setStream(localStream);\n      if (userVideo.current) {\n        userVideo.current.srcObject = localStream;\n        // Show local video in normal (non-mirrored) mode.\n        userVideo.current.style.transform = \"scaleX(1)\";\n        userVideo.current.muted = true;\n      }\n      const peer = new SimplePeer({\n        initiator,\n        trickle: false,\n        stream: localStream,\n        config: {\n          iceServers: [\n            { urls: \"stun:stun.l.google.com:19302\" },\n            {\n              urls: \"turn:35.232.251.11:3478?transport=udp\",\n              username: \"mujib.rabin\",\n              credential: \"rabin\",\n            },\n          ],\n        },\n      });\n      peer.on(\"signal\", (signal) => {\n        console.log(\"Sending signal:\", signal);\n        socket.emit(\"signal\", { partnerId, signal });\n      });\n      peer.on(\"stream\", (remoteStream) => {\n        console.log(\"Remote stream received. Audio tracks:\", remoteStream.getAudioTracks().length);\n        setPartnerStream(remoteStream);\n        if (partnerVideo.current) {\n          partnerVideo.current.srcObject = remoteStream;\n          partnerVideo.current.muted = false;\n          partnerVideo.current.volume = 1.0;\n          partnerVideo.current.onloadedmetadata = () => {\n            partnerVideo.current\n              .play()\n              .catch((err) => console.error(\"Error playing remote stream:\", err));\n            // Hide loading indicator when remote video is ready\n            setVideoLoading(false);\n          };\n        }\n      });\n      peer.on(\"connect\", () => {\n        console.log(\"Peer connected!\");\n        const videoSender = peer._pc.getSenders().find((s) => s.track && s.track.kind === \"video\");\n        videoSenderRef.current = videoSender || null;\n      });\n      peer.on(\"error\", (err) => console.error(\"Peer error:\", err));\n      peer.on(\"iceStateChange\", (state) => console.log(\"ICE state:\", state));\n      peerRef.current = peer;\n    } catch (err) {\n      console.error(\"Error accessing media devices:\", err);\n    }\n  };\n\n  // Replace the local video track without restarting the call\n  const replaceLocalTrack = async () => {\n    if (!peerRef.current) return;\n    const newStream = await navigator.mediaDevices.getUserMedia({\n      video: { facingMode: cameraFacing },\n      audio: false,\n    });\n    const newVideoTrack = newStream.getVideoTracks()[0];\n    if (videoSenderRef.current && newVideoTrack) {\n      await videoSenderRef.current.replaceTrack(newVideoTrack);\n      if (userVideo.current) {\n        userVideo.current.srcObject = newStream;\n        userVideo.current.style.transform = \"scaleX(1)\";\n        userVideo.current.muted = true;\n      }\n      if (stream) {\n        stream.getTracks().forEach((track) => track.stop());\n      }\n      setStream(newStream);\n    }\n  };\n\n  const cleanupCall = () => {\n    setPartnerId(null);\n    setCommonInterests([]);\n    setPartnerStream(null);\n    setMessages([]);\n    setNewMessage(\"\");\n    if (peerRef.current) {\n      peerRef.current.destroy();\n      peerRef.current = null;\n    }\n    videoSenderRef.current = null;\n    if (stream) {\n      stream.getTracks().forEach((track) => track.stop());\n    }\n    setStream(null);\n  };\n\n  const sendMessage = () => {\n    if (newMessage.trim() === \"\") return;\n    socket.emit(\"sendMessage\", newMessage);\n    setMessages((prev) => [...prev, { sender: \"you\", text: newMessage }]);\n    setNewMessage(\"\");\n  };\n\n  const nextPartner = () => {\n    skipDisconnectAlertRef.current = true;\n    cleanupCall();\n    socket.emit(\"nextPartner\");\n    findPartner();\n  };\n\n  const toggleCamera = async () => {\n    const newFacing = cameraFacing === \"user\" ? \"environment\" : \"user\";\n    setCameraFacing(newFacing);\n    if (peerRef.current) {\n      await replaceLocalTrack();\n    } else {\n      if (stream) {\n        stream.getTracks().forEach((track) => track.stop());\n      }\n      await startVideoChat(true);\n    }\n  };\n\n  return (\n    <div className={`app-wrapper ${partnerId ? \"video-active\" : \"no-partner\"}`}>\n      {/* Sidebar (visible when no partner is set) */}\n      <div className=\"sidebar\">\n        <div className=\"branding\">\n          <h2>TALKVEE</h2>\n          <p>Connect based on interests</p>\n        </div>\n        <div className=\"sidebar-content\">\n          {!partnerId && (\n            <div className=\"partner-search\">\n              <input\n                type=\"text\"\n                value={interests}\n                onChange={(e) => setInterests(e.target.value)}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\") {\n                    findPartner();\n                  }\n                }}\n                placeholder=\"Enter interests (optional)\"\n                className=\"form-control\"\n              />\n              <button\n                onClick={findPartner}\n                disabled={searching}\n                className=\"btn btn-primary mt-3\"\n              >\n                {searching ? \"Searching...\" : \"Find a Partner\"}\n              </button>\n            </div>\n          )}\n          {partnerId && (\n            <div className=\"chat-box\">\n              <div className=\"chat-messages\">\n                {messages.map((msg, index) => (\n                  <div key={index} className={`chat-message ${msg.sender === \"you\" ? \"sent\" : \"received\"}`}>\n                    {msg.text}\n                  </div>\n                ))}\n              </div>\n              <div className=\"chat-input\">\n                <input\n                  type=\"text\"\n                  value={newMessage}\n                  onChange={(e) => setNewMessage(e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\") {\n                      sendMessage();\n                    }\n                  }}\n                  placeholder=\"Type a message...\"\n                />\n                <button onClick={sendMessage} className=\"btn btn-outline-light\">\n                  Send\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      {/* End Sidebar */}\n\n      {/* Main content */}\n      <div className=\"main-content\">\n        {partnerId ? (\n          <>\n            <div className=\"video-container\">\n              {videoLoading && (\n                <div className=\"loading-overlay\">\n                  <p style={{ color: \"#fff\", fontSize: \"1.5rem\" }}>Loading...</p>\n                </div>\n              )}\n              <video ref={partnerVideo} autoPlay playsInline className=\"partner-video\" />\n              <video ref={userVideo} autoPlay playsInline className=\"user-video-overlay\" />\n            </div>\n            <div className=\"common-interests\">\n              <h4>Common Interests:</h4>\n              <p>{commonInterests.length > 0 ? commonInterests.join(\", \") : \"None\"}</p>\n            </div>\n            <div className=\"control-buttons-bottom\">\n              <button onClick={() => window.location.reload()} className=\"btn btn-danger btn-lg\">\n                Disconnect\n              </button>\n              <button onClick={nextPartner} className=\"btn btn-warning btn-lg\">\n                Next\n              </button>\n            </div>\n            {/* Small transparent switch camera icon in host area */}\n            <button className=\"switch-camera\" onClick={toggleCamera}>\n              &#8635;\n            </button>\n            {/* Chat toggle button (visible on mobile via CSS) */}\n            <button className=\"chat-toggle\" onClick={() => setShowChat((prev) => !prev)}>\n              {showChat ? \"Hide Chat\" : \"Show Chat\"}\n            </button>\n            {/* Chat overlay for mobile */}\n            <div className={`chat-overlay ${showChat ? \"active\" : \"\"}`}>\n              <div className=\"chat-messages\">\n                {messages.map((msg, index) => (\n                  <div key={index} className={`chat-message ${msg.sender === \"you\" ? \"sent\" : \"received\"}`}>\n                    {msg.text}\n                  </div>\n                ))}\n              </div>\n              <div className=\"chat-input\">\n                <input\n                  type=\"text\"\n                  value={newMessage}\n                  onChange={(e) => setNewMessage(e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\") {\n                      sendMessage();\n                    }\n                  }}\n                  placeholder=\"Type a message...\"\n                />\n                <button onClick={sendMessage}>Send</button>\n              </div>\n            </div>\n          </>\n        ) : (\n          <div className=\"welcome-message\">\n            <h3>Welcome to TALKVEE</h3>\n            <p>MAY CONTAIN WEIRD BUT FUN PEOPLE.</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,OAAOC,EAAE,MAAM,kBAAkB;AACjC,OAAOC,UAAU,MAAM,aAAa;AACpC,OAAO,sCAAsC;AAC7C,OAAO,WAAW;;AAElB;AAAA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AACA,MAAMC,MAAM,GAAGN,EAAE,CAAC,gDAAgD,CAAC;AAEnE,SAASO,GAAGA,CAAA,EAAG;EAAAC,EAAA;EACb,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACc,SAAS,EAAEC,YAAY,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACgB,SAAS,EAAEC,YAAY,CAAC,GAAGjB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACkB,eAAe,EAAEC,kBAAkB,CAAC,GAAGnB,QAAQ,CAAC,EAAE,CAAC;EAC1D,MAAM,CAACoB,MAAM,EAAEC,SAAS,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM,CAACsB,aAAa,EAAEC,gBAAgB,CAAC,GAAGvB,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAM,CAACwB,IAAI,EAAEC,OAAO,CAAC,GAAGzB,QAAQ,CAAC,EAAE,CAAC;EACpC,MAAM,CAAC0B,QAAQ,EAAEC,WAAW,CAAC,GAAG3B,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAAC4B,UAAU,EAAEC,aAAa,CAAC,GAAG7B,QAAQ,CAAC,EAAE,CAAC;EAChD;EACA,MAAM,CAAC8B,QAAQ,EAAEC,WAAW,CAAC,GAAG/B,QAAQ,CAAC,KAAK,CAAC;EAC/C;EACA,MAAM,CAACgC,YAAY,EAAEC,eAAe,CAAC,GAAGjC,QAAQ,CAAC,MAAM,CAAC;EACxD;EACA,MAAM,CAACkC,YAAY,EAAEC,eAAe,CAAC,GAAGnC,QAAQ,CAAC,KAAK,CAAC;EACvD;EACA,MAAMoC,sBAAsB,GAAGlC,MAAM,CAAC,KAAK,CAAC;EAE5C,MAAMmC,SAAS,GAAGnC,MAAM,CAAC,CAAC;EAC1B,MAAMoC,YAAY,GAAGpC,MAAM,CAAC,CAAC;EAC7B,MAAMqC,OAAO,GAAGrC,MAAM,CAAC,IAAI,CAAC;EAC5B;EACA,MAAMsC,cAAc,GAAGtC,MAAM,CAAC,IAAI,CAAC;;EAEnC;EACAD,SAAS,CAAC,MAAM;IACd,MAAMwC,KAAK,GAAGA,CAAA,KAAM;MAClB,MAAMC,EAAE,GAAGC,MAAM,CAACC,WAAW,GAAG,IAAI;MACpCC,QAAQ,CAACC,eAAe,CAACC,KAAK,CAACC,WAAW,CAAC,MAAM,EAAE,GAAGN,EAAE,IAAI,CAAC;IAC/D,CAAC;IACDD,KAAK,CAAC,CAAC;IACPE,MAAM,CAACM,gBAAgB,CAAC,QAAQ,EAAER,KAAK,CAAC;IACxC,OAAO,MAAME,MAAM,CAACO,mBAAmB,CAAC,QAAQ,EAAET,KAAK,CAAC;EAC1D,CAAC,EAAE,EAAE,CAAC;EAENxC,SAAS,CAAC,MAAM;IACdQ,MAAM,CAAC0C,EAAE,CAAC,SAAS,EAAE,MAAM;MACzBC,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAE5C,MAAM,CAAC6C,EAAE,CAAC;MAC5C7B,OAAO,CAAChB,MAAM,CAAC6C,EAAE,CAAC;IACpB,CAAC,CAAC;IAEF7C,MAAM,CAAC0C,EAAE,CAAC,cAAc,EAAE,CAAC;MAAEvC,SAAS;MAAEM;IAAgB,CAAC,KAAK;MAC5DkC,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEzC,SAAS,EAAEM,eAAe,CAAC;MACzDL,YAAY,CAACD,SAAS,CAAC;MACvBO,kBAAkB,CAACD,eAAe,CAAC;MACnCH,YAAY,CAAC,KAAK,CAAC;MACnB;MACAoB,eAAe,CAAC,IAAI,CAAC;IACvB,CAAC,CAAC;IAEF1B,MAAM,CAAC0C,EAAE,CAAC,QAAQ,EAAE,CAAC;MAAEI;IAAO,CAAC,KAAK;MAClCH,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEE,MAAM,CAAC;MACvC,IAAIhB,OAAO,CAACiB,OAAO,EAAE;QACnBjB,OAAO,CAACiB,OAAO,CAACD,MAAM,CAACA,MAAM,CAAC;MAChC;IACF,CAAC,CAAC;IAEF9C,MAAM,CAAC0C,EAAE,CAAC,qBAAqB,EAAE,MAAM;MACrCC,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;MACnC,IAAIjB,sBAAsB,CAACoB,OAAO,EAAE;QAClCpB,sBAAsB,CAACoB,OAAO,GAAG,KAAK;MACxC,CAAC,MAAM;QACLC,KAAK,CAAC,qCAAqC,CAAC;MAC9C;MACAC,WAAW,CAAC,CAAC;MACbC,WAAW,CAAC,CAAC;IACf,CAAC,CAAC;IAEFlD,MAAM,CAAC0C,EAAE,CAAC,gBAAgB,EAAGS,OAAO,IAAK;MACvCR,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEO,OAAO,CAAC;MACzCjC,WAAW,CAAEkC,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAE;QAAEC,MAAM,EAAE,SAAS;QAAEC,IAAI,EAAEH;MAAQ,CAAC,CAAC,CAAC;IACxE,CAAC,CAAC;IAEF,OAAO,MAAM;MACXnD,MAAM,CAACuD,GAAG,CAAC,SAAS,CAAC;MACrBvD,MAAM,CAACuD,GAAG,CAAC,cAAc,CAAC;MAC1BvD,MAAM,CAACuD,GAAG,CAAC,QAAQ,CAAC;MACpBvD,MAAM,CAACuD,GAAG,CAAC,qBAAqB,CAAC;MACjCvD,MAAM,CAACuD,GAAG,CAAC,gBAAgB,CAAC;IAC9B,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN/D,SAAS,CAAC,MAAM;IACd,IAAIW,SAAS,IAAIY,IAAI,IAAI,CAACe,OAAO,CAACiB,OAAO,EAAE;MACzC,MAAMS,SAAS,GAAGzC,IAAI,GAAGZ,SAAS;MAClCwC,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAEY,SAAS,CAAC;MACzDC,cAAc,CAACD,SAAS,CAAC;IAC3B;EACF,CAAC,EAAE,CAACrD,SAAS,EAAEY,IAAI,EAAEQ,YAAY,CAAC,CAAC;EAEnC,MAAM2B,WAAW,GAAGA,CAAA,KAAM;IACxB5C,YAAY,CAAC,IAAI,CAAC;IAClB,MAAMoD,YAAY,GAAGnD,SAAS,CAACoD,IAAI,CAAC,CAAC,GACjCpD,SAAS,CAACqD,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAAEC,CAAC,IAAKA,CAAC,CAACH,IAAI,CAAC,CAAC,CAACI,WAAW,CAAC,CAAC,CAAC,GACvD,EAAE;IACNpB,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAEc,YAAY,CAAC;IAC5D1D,MAAM,CAACgE,IAAI,CAAC,aAAa,EAAEN,YAAY,CAAC;EAC1C,CAAC;EAED,MAAMD,cAAc,GAAG,MAAOD,SAAS,IAAK;IAC1C,IAAI;MACF,MAAMS,WAAW,GAAG,MAAMC,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC;QAC5DC,KAAK,EAAE;UAAEC,UAAU,EAAE/C;QAAa,CAAC;QACnCgD,KAAK,EAAE;UACLC,gBAAgB,EAAE,IAAI;UACtBC,gBAAgB,EAAE,IAAI;UACtBC,eAAe,EAAE,IAAI;UACrBC,UAAU,EAAE,KAAK;UACjBC,YAAY,EAAE;QAChB;MACF,CAAC,CAAC;MACFhE,SAAS,CAACqD,WAAW,CAAC;MACtB,IAAIrC,SAAS,CAACmB,OAAO,EAAE;QACrBnB,SAAS,CAACmB,OAAO,CAAC8B,SAAS,GAAGZ,WAAW;QACzC;QACArC,SAAS,CAACmB,OAAO,CAACT,KAAK,CAACwC,SAAS,GAAG,WAAW;QAC/ClD,SAAS,CAACmB,OAAO,CAACgC,KAAK,GAAG,IAAI;MAChC;MACA,MAAMC,IAAI,GAAG,IAAIrF,UAAU,CAAC;QAC1B6D,SAAS;QACTyB,OAAO,EAAE,KAAK;QACdtE,MAAM,EAAEsD,WAAW;QACnBiB,MAAM,EAAE;UACNC,UAAU,EAAE,CACV;YAAEC,IAAI,EAAE;UAA+B,CAAC,EACxC;YACEA,IAAI,EAAE,uCAAuC;YAC7CC,QAAQ,EAAE,aAAa;YACvBC,UAAU,EAAE;UACd,CAAC;QAEL;MACF,CAAC,CAAC;MACFN,IAAI,CAACtC,EAAE,CAAC,QAAQ,EAAGI,MAAM,IAAK;QAC5BH,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEE,MAAM,CAAC;QACtC9C,MAAM,CAACgE,IAAI,CAAC,QAAQ,EAAE;UAAE7D,SAAS;UAAE2C;QAAO,CAAC,CAAC;MAC9C,CAAC,CAAC;MACFkC,IAAI,CAACtC,EAAE,CAAC,QAAQ,EAAG6C,YAAY,IAAK;QAClC5C,OAAO,CAACC,GAAG,CAAC,uCAAuC,EAAE2C,YAAY,CAACC,cAAc,CAAC,CAAC,CAACC,MAAM,CAAC;QAC1F3E,gBAAgB,CAACyE,YAAY,CAAC;QAC9B,IAAI1D,YAAY,CAACkB,OAAO,EAAE;UACxBlB,YAAY,CAACkB,OAAO,CAAC8B,SAAS,GAAGU,YAAY;UAC7C1D,YAAY,CAACkB,OAAO,CAACgC,KAAK,GAAG,KAAK;UAClClD,YAAY,CAACkB,OAAO,CAAC2C,MAAM,GAAG,GAAG;UACjC7D,YAAY,CAACkB,OAAO,CAAC4C,gBAAgB,GAAG,MAAM;YAC5C9D,YAAY,CAACkB,OAAO,CACjB6C,IAAI,CAAC,CAAC,CACNC,KAAK,CAAEC,GAAG,IAAKnD,OAAO,CAACoD,KAAK,CAAC,8BAA8B,EAAED,GAAG,CAAC,CAAC;YACrE;YACApE,eAAe,CAAC,KAAK,CAAC;UACxB,CAAC;QACH;MACF,CAAC,CAAC;MACFsD,IAAI,CAACtC,EAAE,CAAC,SAAS,EAAE,MAAM;QACvBC,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;QAC9B,MAAMoD,WAAW,GAAGhB,IAAI,CAACiB,GAAG,CAACC,UAAU,CAAC,CAAC,CAACC,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAACC,KAAK,IAAID,CAAC,CAACC,KAAK,CAACC,IAAI,KAAK,OAAO,CAAC;QAC1FvE,cAAc,CAACgB,OAAO,GAAGiD,WAAW,IAAI,IAAI;MAC9C,CAAC,CAAC;MACFhB,IAAI,CAACtC,EAAE,CAAC,OAAO,EAAGoD,GAAG,IAAKnD,OAAO,CAACoD,KAAK,CAAC,aAAa,EAAED,GAAG,CAAC,CAAC;MAC5Dd,IAAI,CAACtC,EAAE,CAAC,gBAAgB,EAAG6D,KAAK,IAAK5D,OAAO,CAACC,GAAG,CAAC,YAAY,EAAE2D,KAAK,CAAC,CAAC;MACtEzE,OAAO,CAACiB,OAAO,GAAGiC,IAAI;IACxB,CAAC,CAAC,OAAOc,GAAG,EAAE;MACZnD,OAAO,CAACoD,KAAK,CAAC,gCAAgC,EAAED,GAAG,CAAC;IACtD;EACF,CAAC;;EAED;EACA,MAAMU,iBAAiB,GAAG,MAAAA,CAAA,KAAY;IACpC,IAAI,CAAC1E,OAAO,CAACiB,OAAO,EAAE;IACtB,MAAM0D,SAAS,GAAG,MAAMvC,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC;MAC1DC,KAAK,EAAE;QAAEC,UAAU,EAAE/C;MAAa,CAAC;MACnCgD,KAAK,EAAE;IACT,CAAC,CAAC;IACF,MAAMmC,aAAa,GAAGD,SAAS,CAACE,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC;IACnD,IAAI5E,cAAc,CAACgB,OAAO,IAAI2D,aAAa,EAAE;MAC3C,MAAM3E,cAAc,CAACgB,OAAO,CAAC6D,YAAY,CAACF,aAAa,CAAC;MACxD,IAAI9E,SAAS,CAACmB,OAAO,EAAE;QACrBnB,SAAS,CAACmB,OAAO,CAAC8B,SAAS,GAAG4B,SAAS;QACvC7E,SAAS,CAACmB,OAAO,CAACT,KAAK,CAACwC,SAAS,GAAG,WAAW;QAC/ClD,SAAS,CAACmB,OAAO,CAACgC,KAAK,GAAG,IAAI;MAChC;MACA,IAAIpE,MAAM,EAAE;QACVA,MAAM,CAACkG,SAAS,CAAC,CAAC,CAACC,OAAO,CAAET,KAAK,IAAKA,KAAK,CAACU,IAAI,CAAC,CAAC,CAAC;MACrD;MACAnG,SAAS,CAAC6F,SAAS,CAAC;IACtB;EACF,CAAC;EAED,MAAMxD,WAAW,GAAGA,CAAA,KAAM;IACxB7C,YAAY,CAAC,IAAI,CAAC;IAClBM,kBAAkB,CAAC,EAAE,CAAC;IACtBI,gBAAgB,CAAC,IAAI,CAAC;IACtBI,WAAW,CAAC,EAAE,CAAC;IACfE,aAAa,CAAC,EAAE,CAAC;IACjB,IAAIU,OAAO,CAACiB,OAAO,EAAE;MACnBjB,OAAO,CAACiB,OAAO,CAACiE,OAAO,CAAC,CAAC;MACzBlF,OAAO,CAACiB,OAAO,GAAG,IAAI;IACxB;IACAhB,cAAc,CAACgB,OAAO,GAAG,IAAI;IAC7B,IAAIpC,MAAM,EAAE;MACVA,MAAM,CAACkG,SAAS,CAAC,CAAC,CAACC,OAAO,CAAET,KAAK,IAAKA,KAAK,CAACU,IAAI,CAAC,CAAC,CAAC;IACrD;IACAnG,SAAS,CAAC,IAAI,CAAC;EACjB,CAAC;EAED,MAAMqG,WAAW,GAAGA,CAAA,KAAM;IACxB,IAAI9F,UAAU,CAACwC,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE;IAC9B3D,MAAM,CAACgE,IAAI,CAAC,aAAa,EAAE7C,UAAU,CAAC;IACtCD,WAAW,CAAEkC,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAE;MAAEC,MAAM,EAAE,KAAK;MAAEC,IAAI,EAAEnC;IAAW,CAAC,CAAC,CAAC;IACrEC,aAAa,CAAC,EAAE,CAAC;EACnB,CAAC;EAED,MAAM8F,WAAW,GAAGA,CAAA,KAAM;IACxBvF,sBAAsB,CAACoB,OAAO,GAAG,IAAI;IACrCE,WAAW,CAAC,CAAC;IACbjD,MAAM,CAACgE,IAAI,CAAC,aAAa,CAAC;IAC1Bd,WAAW,CAAC,CAAC;EACf,CAAC;EAED,MAAMiE,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC/B,MAAMC,SAAS,GAAG7F,YAAY,KAAK,MAAM,GAAG,aAAa,GAAG,MAAM;IAClEC,eAAe,CAAC4F,SAAS,CAAC;IAC1B,IAAItF,OAAO,CAACiB,OAAO,EAAE;MACnB,MAAMyD,iBAAiB,CAAC,CAAC;IAC3B,CAAC,MAAM;MACL,IAAI7F,MAAM,EAAE;QACVA,MAAM,CAACkG,SAAS,CAAC,CAAC,CAACC,OAAO,CAAET,KAAK,IAAKA,KAAK,CAACU,IAAI,CAAC,CAAC,CAAC;MACrD;MACA,MAAMtD,cAAc,CAAC,IAAI,CAAC;IAC5B;EACF,CAAC;EAED,oBACE5D,OAAA;IAAKwH,SAAS,EAAE,eAAelH,SAAS,GAAG,cAAc,GAAG,YAAY,EAAG;IAAAmH,QAAA,gBAEzEzH,OAAA;MAAKwH,SAAS,EAAC,SAAS;MAAAC,QAAA,gBACtBzH,OAAA;QAAKwH,SAAS,EAAC,UAAU;QAAAC,QAAA,gBACvBzH,OAAA;UAAAyH,QAAA,EAAI;QAAO;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAChB7H,OAAA;UAAAyH,QAAA,EAAG;QAA0B;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9B,CAAC,eACN7H,OAAA;QAAKwH,SAAS,EAAC,iBAAiB;QAAAC,QAAA,GAC7B,CAACnH,SAAS,iBACTN,OAAA;UAAKwH,SAAS,EAAC,gBAAgB;UAAAC,QAAA,gBAC7BzH,OAAA;YACE8H,IAAI,EAAC,MAAM;YACXC,KAAK,EAAErH,SAAU;YACjBsH,QAAQ,EAAGC,CAAC,IAAKtH,YAAY,CAACsH,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;YAC9CI,SAAS,EAAGF,CAAC,IAAK;cAChB,IAAIA,CAAC,CAACG,GAAG,KAAK,OAAO,EAAE;gBACrB/E,WAAW,CAAC,CAAC;cACf;YACF,CAAE;YACFgF,WAAW,EAAC,4BAA4B;YACxCb,SAAS,EAAC;UAAc;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzB,CAAC,eACF7H,OAAA;YACEsI,OAAO,EAAEjF,WAAY;YACrBkF,QAAQ,EAAE/H,SAAU;YACpBgH,SAAS,EAAC,sBAAsB;YAAAC,QAAA,EAE/BjH,SAAS,GAAG,cAAc,GAAG;UAAgB;YAAAkH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACxC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CACN,EACAvH,SAAS,iBACRN,OAAA;UAAKwH,SAAS,EAAC,UAAU;UAAAC,QAAA,gBACvBzH,OAAA;YAAKwH,SAAS,EAAC,eAAe;YAAAC,QAAA,EAC3BrG,QAAQ,CAAC4C,GAAG,CAAC,CAACwE,GAAG,EAAEC,KAAK,kBACvBzI,OAAA;cAAiBwH,SAAS,EAAE,gBAAgBgB,GAAG,CAAChF,MAAM,KAAK,KAAK,GAAG,MAAM,GAAG,UAAU,EAAG;cAAAiE,QAAA,EACtFe,GAAG,CAAC/E;YAAI,GADDgF,KAAK;cAAAf,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAEV,CACN;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC,eACN7H,OAAA;YAAKwH,SAAS,EAAC,YAAY;YAAAC,QAAA,gBACzBzH,OAAA;cACE8H,IAAI,EAAC,MAAM;cACXC,KAAK,EAAEzG,UAAW;cAClB0G,QAAQ,EAAGC,CAAC,IAAK1G,aAAa,CAAC0G,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;cAC/CI,SAAS,EAAGF,CAAC,IAAK;gBAChB,IAAIA,CAAC,CAACG,GAAG,KAAK,OAAO,EAAE;kBACrBhB,WAAW,CAAC,CAAC;gBACf;cACF,CAAE;cACFiB,WAAW,EAAC;YAAmB;cAAAX,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAChC,CAAC,eACF7H,OAAA;cAAQsI,OAAO,EAAElB,WAAY;cAACI,SAAS,EAAC,uBAAuB;cAAAC,QAAA,EAAC;YAEhE;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAIN7H,OAAA;MAAKwH,SAAS,EAAC,cAAc;MAAAC,QAAA,EAC1BnH,SAAS,gBACRN,OAAA,CAAAE,SAAA;QAAAuH,QAAA,gBACEzH,OAAA;UAAKwH,SAAS,EAAC,iBAAiB;UAAAC,QAAA,GAC7B7F,YAAY,iBACX5B,OAAA;YAAKwH,SAAS,EAAC,iBAAiB;YAAAC,QAAA,eAC9BzH,OAAA;cAAGyC,KAAK,EAAE;gBAAEiG,KAAK,EAAE,MAAM;gBAAEC,QAAQ,EAAE;cAAS,CAAE;cAAAlB,QAAA,EAAC;YAAU;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5D,CACN,eACD7H,OAAA;YAAO4I,GAAG,EAAE5G,YAAa;YAAC6G,QAAQ;YAACC,WAAW;YAACtB,SAAS,EAAC;UAAe;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAC3E7H,OAAA;YAAO4I,GAAG,EAAE7G,SAAU;YAAC8G,QAAQ;YAACC,WAAW;YAACtB,SAAS,EAAC;UAAoB;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC1E,CAAC,eACN7H,OAAA;UAAKwH,SAAS,EAAC,kBAAkB;UAAAC,QAAA,gBAC/BzH,OAAA;YAAAyH,QAAA,EAAI;UAAiB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC1B7H,OAAA;YAAAyH,QAAA,EAAI7G,eAAe,CAACgF,MAAM,GAAG,CAAC,GAAGhF,eAAe,CAACmI,IAAI,CAAC,IAAI,CAAC,GAAG;UAAM;YAAArB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtE,CAAC,eACN7H,OAAA;UAAKwH,SAAS,EAAC,wBAAwB;UAAAC,QAAA,gBACrCzH,OAAA;YAAQsI,OAAO,EAAEA,CAAA,KAAMjG,MAAM,CAAC2G,QAAQ,CAACC,MAAM,CAAC,CAAE;YAACzB,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAEnF;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACT7H,OAAA;YAAQsI,OAAO,EAAEjB,WAAY;YAACG,SAAS,EAAC,wBAAwB;YAAAC,QAAA,EAAC;UAEjE;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC,eAEN7H,OAAA;UAAQwH,SAAS,EAAC,eAAe;UAACc,OAAO,EAAEhB,YAAa;UAAAG,QAAA,EAAC;QAEzD;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAET7H,OAAA;UAAQwH,SAAS,EAAC,aAAa;UAACc,OAAO,EAAEA,CAAA,KAAM7G,WAAW,CAAE8B,IAAI,IAAK,CAACA,IAAI,CAAE;UAAAkE,QAAA,EACzEjG,QAAQ,GAAG,WAAW,GAAG;QAAW;UAAAkG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/B,CAAC,eAET7H,OAAA;UAAKwH,SAAS,EAAE,gBAAgBhG,QAAQ,GAAG,QAAQ,GAAG,EAAE,EAAG;UAAAiG,QAAA,gBACzDzH,OAAA;YAAKwH,SAAS,EAAC,eAAe;YAAAC,QAAA,EAC3BrG,QAAQ,CAAC4C,GAAG,CAAC,CAACwE,GAAG,EAAEC,KAAK,kBACvBzI,OAAA;cAAiBwH,SAAS,EAAE,gBAAgBgB,GAAG,CAAChF,MAAM,KAAK,KAAK,GAAG,MAAM,GAAG,UAAU,EAAG;cAAAiE,QAAA,EACtFe,GAAG,CAAC/E;YAAI,GADDgF,KAAK;cAAAf,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAEV,CACN;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC,eACN7H,OAAA;YAAKwH,SAAS,EAAC,YAAY;YAAAC,QAAA,gBACzBzH,OAAA;cACE8H,IAAI,EAAC,MAAM;cACXC,KAAK,EAAEzG,UAAW;cAClB0G,QAAQ,EAAGC,CAAC,IAAK1G,aAAa,CAAC0G,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;cAC/CI,SAAS,EAAGF,CAAC,IAAK;gBAChB,IAAIA,CAAC,CAACG,GAAG,KAAK,OAAO,EAAE;kBACrBhB,WAAW,CAAC,CAAC;gBACf;cACF,CAAE;cACFiB,WAAW,EAAC;YAAmB;cAAAX,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAChC,CAAC,eACF7H,OAAA;cAAQsI,OAAO,EAAElB,WAAY;cAAAK,QAAA,EAAC;YAAI;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACxC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA,eACN,CAAC,gBAEH7H,OAAA;QAAKwH,SAAS,EAAC,iBAAiB;QAAAC,QAAA,gBAC9BzH,OAAA;UAAAyH,QAAA,EAAI;QAAkB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC3B7H,OAAA;UAAAyH,QAAA,EAAG;QAAiC;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACrC;IACN;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAACxH,EAAA,CA3WQD,GAAG;AAAA8I,EAAA,GAAH9I,GAAG;AA6WZ,eAAeA,GAAG;AAAC,IAAA8I,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}