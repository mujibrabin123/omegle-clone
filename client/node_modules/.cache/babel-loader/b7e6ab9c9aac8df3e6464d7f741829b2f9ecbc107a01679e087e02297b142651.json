{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mujib\\\\omegle-clone\\\\client\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\n// App.js\nimport React, { useState, useEffect, useRef } from \"react\";\nimport io from \"socket.io-client\";\nimport SimplePeer from \"simple-peer\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./App.css\";\n\n// Import authentication dependencies\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { auth } from \"./firebase\";\nimport SignIn from \"./SignIn\";\n\n// Use your server URL.\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst backendUrl = window.location.hostname === \"localhost\" ? \"http://localhost:3000\" : \"https://server-crimson-wildflower-4430.fly.dev\";\nconst socket = io(backendUrl);\nfunction App() {\n  _s();\n  // Authentication state\n  const [user, setUser] = useState(null);\n\n  // Existing state variables for your app\n  const [partnerId, setPartnerId] = useState(null);\n  const [searching, setSearching] = useState(false);\n  const [interests, setInterests] = useState(\"\");\n  const [commonInterests, setCommonInterests] = useState([]);\n  const [stream, setStream] = useState(null);\n  const [partnerStream, setPartnerStream] = useState(null);\n  const [myId, setMyId] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [showChat, setShowChat] = useState(false);\n  const [cameraFacing, setCameraFacing] = useState(\"user\");\n  const [videoLoading, setVideoLoading] = useState(false);\n  const skipDisconnectAlertRef = useRef(false);\n  const userVideo = useRef();\n  const partnerVideo = useRef();\n  const peerRef = useRef(null);\n  const videoSenderRef = useRef(null);\n\n  // Set dynamic viewport height.\n  useEffect(() => {\n    const setVh = () => {\n      const vh = window.innerHeight * 0.01;\n      document.documentElement.style.setProperty(\"--vh\", `${vh}px`);\n    };\n    setVh();\n    window.addEventListener(\"resize\", setVh);\n    return () => window.removeEventListener(\"resize\", setVh);\n  }, []);\n\n  // Preinitialize the camera stream.\n  useEffect(() => {\n    async function preInitialize() {\n      try {\n        if (!stream) {\n          const preStream = await navigator.mediaDevices.getUserMedia({\n            video: {\n              facingMode: cameraFacing\n            },\n            audio: false\n          });\n          setStream(preStream);\n          if (userVideo.current) {\n            userVideo.current.srcObject = preStream;\n            userVideo.current.style.transform = \"scaleX(1)\";\n            userVideo.current.muted = true;\n          }\n        }\n      } catch (e) {\n        console.error(\"Preinitialize error:\", e);\n      }\n    }\n    preInitialize();\n  }, [cameraFacing, stream]);\n\n  // Authentication listener.\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, currentUser => {\n      setUser(currentUser);\n    });\n    return unsubscribe;\n  }, []);\n\n  // Optional: additional logic when user is authenticated.\n  useEffect(() => {\n    if (user) {\n      console.log(\"User authenticated:\", user);\n    }\n  }, [user]);\n\n  // Define handleSignIn to emit the socket event and update state.\n  const handleSignIn = firebaseUser => {\n    console.log(\"User signed in:\", firebaseUser);\n    setUser(firebaseUser);\n    socket.emit(\"userAuthenticated\", {\n      uid: firebaseUser.uid,\n      displayName: firebaseUser.displayName,\n      email: firebaseUser.email\n    });\n  };\n\n  // Function to report partner.\n  const reportPartner = () => {\n    if (partnerId) {\n      if (window.confirm(\"Are you sure you want to report this user?\")) {\n        console.log(\"Reporting partner with socket ID:\", partnerId);\n        const sessionMessagesData = messages.map(msg => msg.text);\n        console.log(\"Session messages being sent:\", sessionMessagesData);\n        socket.emit(\"reportUser\", {\n          reportedSocketId: partnerId,\n          sessionMessages: sessionMessagesData\n        });\n      }\n    }\n  };\n\n  // Socket event listeners.\n  useEffect(() => {\n    socket.on(\"connect\", () => {\n      console.log(\"Connected with ID:\", socket.id);\n      setMyId(socket.id);\n    });\n    socket.on(\"partnerFound\", ({\n      partnerId,\n      commonInterests\n    }) => {\n      console.log(\"Partner found:\", partnerId, commonInterests);\n      setPartnerId(partnerId);\n      setCommonInterests(commonInterests);\n      setSearching(false);\n      setVideoLoading(true);\n    });\n    socket.on(\"signal\", ({\n      signal\n    }) => {\n      console.log(\"Signal received:\", signal);\n      if (peerRef.current) {\n        peerRef.current.signal(signal);\n      }\n    });\n    socket.on(\"partnerDisconnected\", () => {\n      console.log(\"Partner disconnected\");\n      if (skipDisconnectAlertRef.current) {\n        skipDisconnectAlertRef.current = false;\n      } else {\n        alert(\"Your chat partner has disconnected.\");\n      }\n      cleanupCall();\n      findPartner();\n    });\n    socket.on(\"receiveMessage\", message => {\n      console.log(\"Message received:\", message);\n      setMessages(prev => [...prev, {\n        sender: \"partner\",\n        text: message\n      }]);\n    });\n\n    // Listen for banned event.\n    socket.on(\"banned\", msg => {\n      alert(msg);\n    });\n    return () => {\n      socket.off(\"connect\");\n      socket.off(\"partnerFound\");\n      socket.off(\"signal\");\n      socket.off(\"partnerDisconnected\");\n      socket.off(\"receiveMessage\");\n      socket.off(\"banned\");\n    };\n  }, []);\n\n  // Start the call if partnerId is set and peer hasn't been created yet.\n  useEffect(() => {\n    if (partnerId && myId && !peerRef.current) {\n      const initiator = myId < partnerId;\n      console.log(\"Starting video chat. Initiator:\", initiator);\n      startVideoChat(initiator);\n    }\n  }, [partnerId, myId, cameraFacing]);\n\n  // Functions remain the same.\n  const findPartner = () => {\n    setSearching(true);\n    const interestList = interests.trim() ? interests.split(\",\").map(i => i.trim().toLowerCase()) : [];\n    console.log(\"Finding partner with interests:\", interestList);\n    socket.emit(\"findPartner\", interestList);\n  };\n  const startVideoChat = async initiator => {\n    try {\n      const localStream = stream ? stream : await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: cameraFacing\n        },\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          sampleRate: 48000,\n          channelCount: 2\n        }\n      });\n      if (!stream) setStream(localStream);\n      if (userVideo.current) {\n        userVideo.current.srcObject = localStream;\n        userVideo.current.style.transform = \"scaleX(1)\";\n        userVideo.current.muted = true;\n      }\n      const peer = new SimplePeer({\n        initiator,\n        trickle: true,\n        stream: localStream,\n        config: {\n          iceServers: [{\n            urls: \"stun:stun.l.google.com:19302\"\n          }, {\n            urls: \"turn:35.232.251.11:3478?transport=udp\",\n            username: \"mujib.rabin\",\n            credential: \"rabin\"\n          }, {\n            urls: \"turn:35.232.251.11:3478?transport=tcp\",\n            username: \"mujib.rabin\",\n            credential: \"rabin\"\n          }, {\n            urls: \"turns:35.232.251.11:5349\",\n            username: \"mujib.rabin\",\n            credential: \"rabin\"\n          }]\n        }\n      });\n      peer.on(\"signal\", signal => {\n        console.log(\"Sending signal:\", signal);\n        socket.emit(\"signal\", {\n          partnerId,\n          signal\n        });\n      });\n      peer.on(\"stream\", remoteStream => {\n        console.log(\"Remote stream received. Audio tracks:\", remoteStream.getAudioTracks().length);\n        setPartnerStream(remoteStream);\n        if (partnerVideo.current) {\n          partnerVideo.current.srcObject = remoteStream;\n          partnerVideo.current.muted = false;\n          partnerVideo.current.volume = 1.0;\n          partnerVideo.current.onloadedmetadata = () => {\n            partnerVideo.current.play().catch(err => console.error(\"Error playing remote stream:\", err));\n            setVideoLoading(false);\n          };\n        }\n      });\n      peer.on(\"connect\", () => {\n        console.log(\"Peer connected!\");\n        const videoSender = peer._pc.getSenders().find(s => s.track && s.track.kind === \"video\");\n        videoSenderRef.current = videoSender || null;\n      });\n      peer.on(\"error\", err => console.error(\"Peer error:\", err));\n      peer.on(\"iceStateChange\", state => console.log(\"ICE state:\", state));\n      peerRef.current = peer;\n    } catch (err) {\n      console.error(\"Error accessing media devices:\", err);\n    }\n  };\n  const replaceLocalTrack = async () => {\n    if (!peerRef.current) return;\n    const newStream = await navigator.mediaDevices.getUserMedia({\n      video: {\n        facingMode: cameraFacing\n      },\n      audio: false\n    });\n    const newVideoTrack = newStream.getVideoTracks()[0];\n    if (videoSenderRef.current && newVideoTrack) {\n      await videoSenderRef.current.replaceTrack(newVideoTrack);\n      if (userVideo.current) {\n        userVideo.current.srcObject = newStream;\n        userVideo.current.style.transform = \"scaleX(1)\";\n        userVideo.current.muted = true;\n      }\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n      }\n      setStream(newStream);\n    }\n  };\n  const cleanupCall = () => {\n    setPartnerId(null);\n    setCommonInterests([]);\n    setPartnerStream(null);\n    setMessages([]);\n    setNewMessage(\"\");\n    if (peerRef.current) {\n      peerRef.current.destroy();\n      peerRef.current = null;\n    }\n    videoSenderRef.current = null;\n    if (stream) {\n      stream.getTracks().forEach(track => track.stop());\n    }\n    setStream(null);\n  };\n  const sendMessage = () => {\n    if (newMessage.trim() === \"\") return;\n    socket.emit(\"sendMessage\", newMessage);\n    setMessages(prev => [...prev, {\n      sender: \"you\",\n      text: newMessage\n    }]);\n    setNewMessage(\"\");\n  };\n  const nextPartner = () => {\n    skipDisconnectAlertRef.current = true;\n    cleanupCall();\n    socket.emit(\"nextPartner\");\n    findPartner();\n  };\n  const toggleCamera = async () => {\n    const newFacing = cameraFacing === \"user\" ? \"environment\" : \"user\";\n    setCameraFacing(newFacing);\n    if (peerRef.current) {\n      await replaceLocalTrack();\n    } else {\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n      }\n      await startVideoChat(true);\n    }\n  };\n\n  // Render conditionally based on authentication.\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(SignIn, {\n      onSignIn: handleSignIn\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Otherwise, render the main app.\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `app-wrapper ${partnerId ? \"video-active\" : \"no-partner\"}`,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sidebar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"branding\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"TALKVEE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Connect based on interests\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar-content\",\n        children: [!partnerId && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"partner-search\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: interests,\n            onChange: e => setInterests(e.target.value),\n            onKeyDown: e => {\n              if (e.key === \"Enter\") {\n                findPartner();\n              }\n            },\n            placeholder: \"Enter interests (optional)\",\n            className: \"form-control\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: findPartner,\n            disabled: searching,\n            className: \"btn btn-primary mt-3\",\n            children: searching ? \"Searching...\" : \"Find a Partner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 13\n        }, this), partnerId && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-box\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-messages\",\n            children: messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `chat-message ${msg.sender === \"you\" ? \"sent\" : \"received\"}`,\n              children: msg.text\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-input\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: newMessage,\n              onChange: e => setNewMessage(e.target.value),\n              onKeyDown: e => {\n                if (e.key === \"Enter\") {\n                  sendMessage();\n                }\n              },\n              placeholder: \"Type a message...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: sendMessage,\n              className: \"btn btn-outline-light\",\n              children: \"Send\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: \"10px\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                if (window.confirm(\"Are you sure you want to report this user?\")) {\n                  socket.emit(\"reportUser\", {\n                    reportedSocketId: partnerId\n                  });\n                }\n              },\n              className: \"btn btn-danger\",\n              children: \"Report Partner\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-content\",\n      children: partnerId ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-container\",\n          children: [videoLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-overlay\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"loader\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: partnerVideo,\n            autoPlay: true,\n            playsInline: true,\n            className: \"partner-video\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: userVideo,\n            autoPlay: true,\n            playsInline: true,\n            className: \"user-video-overlay\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"common-interests\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Common Interests:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 424,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: commonInterests.length > 0 ? commonInterests.join(\", \") : \"None\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"control-buttons-bottom\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => window.location.reload(),\n            className: \"btn btn-danger btn-lg\",\n            children: \"Disconnect\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: nextPartner,\n            className: \"btn btn-warning btn-lg\",\n            children: \"Next\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"switch-camera\",\n          onClick: toggleCamera,\n          children: \"\\u21BB\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"chat-toggle\",\n          onClick: () => setShowChat(prev => !prev),\n          children: showChat ? \"Hide Chat\" : \"Show Chat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `chat-overlay ${showChat ? \"active\" : \"\"}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-messages\",\n            children: messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `chat-message ${msg.sender === \"you\" ? \"sent\" : \"received\"}`,\n              children: msg.text\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 444,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-input\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: newMessage,\n              onChange: e => setNewMessage(e.target.value),\n              onKeyDown: e => {\n                if (e.key === \"Enter\") {\n                  sendMessage();\n                }\n              },\n              placeholder: \"Type a message...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 450,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: sendMessage,\n              children: \"Send\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"welcome-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Welcome to TALKVEE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"MAY CONTAIN WEIRD BUT FUN PEOPLE.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 338,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"CPbWTDkvl0BxaU78YekmuLkiuzI=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","io","SimplePeer","onAuthStateChanged","auth","SignIn","jsxDEV","_jsxDEV","Fragment","_Fragment","backendUrl","window","location","hostname","socket","App","_s","user","setUser","partnerId","setPartnerId","searching","setSearching","interests","setInterests","commonInterests","setCommonInterests","stream","setStream","partnerStream","setPartnerStream","myId","setMyId","messages","setMessages","newMessage","setNewMessage","showChat","setShowChat","cameraFacing","setCameraFacing","videoLoading","setVideoLoading","skipDisconnectAlertRef","userVideo","partnerVideo","peerRef","videoSenderRef","setVh","vh","innerHeight","document","documentElement","style","setProperty","addEventListener","removeEventListener","preInitialize","preStream","navigator","mediaDevices","getUserMedia","video","facingMode","audio","current","srcObject","transform","muted","e","console","error","unsubscribe","currentUser","log","handleSignIn","firebaseUser","emit","uid","displayName","email","reportPartner","confirm","sessionMessagesData","map","msg","text","reportedSocketId","sessionMessages","on","id","signal","alert","cleanupCall","findPartner","message","prev","sender","off","initiator","startVideoChat","interestList","trim","split","i","toLowerCase","localStream","echoCancellation","noiseSuppression","autoGainControl","sampleRate","channelCount","peer","trickle","config","iceServers","urls","username","credential","remoteStream","getAudioTracks","length","volume","onloadedmetadata","play","catch","err","videoSender","_pc","getSenders","find","s","track","kind","state","replaceLocalTrack","newStream","newVideoTrack","getVideoTracks","replaceTrack","getTracks","forEach","stop","destroy","sendMessage","nextPartner","toggleCamera","newFacing","onSignIn","fileName","_jsxFileName","lineNumber","columnNumber","className","children","type","value","onChange","target","onKeyDown","key","placeholder","onClick","disabled","index","marginTop","ref","autoPlay","playsInline","join","reload","_c","$RefreshReg$"],"sources":["C:/Users/mujib/omegle-clone/client/src/App.js"],"sourcesContent":["// App.js\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport io from \"socket.io-client\";\r\nimport SimplePeer from \"simple-peer\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport \"./App.css\";\r\n\r\n// Import authentication dependencies\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { auth } from \"./firebase\";\r\nimport SignIn from \"./SignIn\";\r\n\r\n// Use your server URL.\r\nconst backendUrl =\r\n  window.location.hostname === \"localhost\"\r\n    ? \"http://localhost:3000\"\r\n    : \"https://server-crimson-wildflower-4430.fly.dev\";\r\nconst socket = io(backendUrl);\r\n\r\nfunction App() {\r\n  // Authentication state\r\n  const [user, setUser] = useState(null);\r\n\r\n  // Existing state variables for your app\r\n  const [partnerId, setPartnerId] = useState(null);\r\n  const [searching, setSearching] = useState(false);\r\n  const [interests, setInterests] = useState(\"\");\r\n  const [commonInterests, setCommonInterests] = useState([]);\r\n  const [stream, setStream] = useState(null);\r\n  const [partnerStream, setPartnerStream] = useState(null);\r\n  const [myId, setMyId] = useState(\"\");\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState(\"\");\r\n  const [showChat, setShowChat] = useState(false);\r\n  const [cameraFacing, setCameraFacing] = useState(\"user\");\r\n  const [videoLoading, setVideoLoading] = useState(false);\r\n  const skipDisconnectAlertRef = useRef(false);\r\n\r\n  const userVideo = useRef();\r\n  const partnerVideo = useRef();\r\n  const peerRef = useRef(null);\r\n  const videoSenderRef = useRef(null);\r\n\r\n  // Set dynamic viewport height.\r\n  useEffect(() => {\r\n    const setVh = () => {\r\n      const vh = window.innerHeight * 0.01;\r\n      document.documentElement.style.setProperty(\"--vh\", `${vh}px`);\r\n    };\r\n    setVh();\r\n    window.addEventListener(\"resize\", setVh);\r\n    return () => window.removeEventListener(\"resize\", setVh);\r\n  }, []);\r\n\r\n  // Preinitialize the camera stream.\r\n  useEffect(() => {\r\n    async function preInitialize() {\r\n      try {\r\n        if (!stream) {\r\n          const preStream = await navigator.mediaDevices.getUserMedia({\r\n            video: { facingMode: cameraFacing },\r\n            audio: false,\r\n          });\r\n          setStream(preStream);\r\n          if (userVideo.current) {\r\n            userVideo.current.srcObject = preStream;\r\n            userVideo.current.style.transform = \"scaleX(1)\";\r\n            userVideo.current.muted = true;\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.error(\"Preinitialize error:\", e);\r\n      }\r\n    }\r\n    preInitialize();\r\n  }, [cameraFacing, stream]);\r\n\r\n  // Authentication listener.\r\n  useEffect(() => {\r\n    const unsubscribe = onAuthStateChanged(auth, (currentUser) => {\r\n      setUser(currentUser);\r\n    });\r\n    return unsubscribe;\r\n  }, []);\r\n\r\n  // Optional: additional logic when user is authenticated.\r\n  useEffect(() => {\r\n    if (user) {\r\n      console.log(\"User authenticated:\", user);\r\n    }\r\n  }, [user]);\r\n\r\n  // Define handleSignIn to emit the socket event and update state.\r\n  const handleSignIn = (firebaseUser) => {\r\n    console.log(\"User signed in:\", firebaseUser);\r\n    setUser(firebaseUser);\r\n    socket.emit(\"userAuthenticated\", {\r\n      uid: firebaseUser.uid,\r\n      displayName: firebaseUser.displayName,\r\n      email: firebaseUser.email,\r\n    });\r\n  };\r\n\r\n  // Function to report partner.\r\n  const reportPartner = () => {\r\n    if (partnerId) {\r\n      if (window.confirm(\"Are you sure you want to report this user?\")) {\r\n        console.log(\"Reporting partner with socket ID:\", partnerId);\r\n        const sessionMessagesData = messages.map((msg) => msg.text);\r\n        console.log(\"Session messages being sent:\", sessionMessagesData);\r\n        socket.emit(\"reportUser\", { reportedSocketId: partnerId, sessionMessages: sessionMessagesData });\r\n      }\r\n    }\r\n  };\r\n  \r\n\r\n  // Socket event listeners.\r\n  useEffect(() => {\r\n    socket.on(\"connect\", () => {\r\n      console.log(\"Connected with ID:\", socket.id);\r\n      setMyId(socket.id);\r\n    });\r\n\r\n    socket.on(\"partnerFound\", ({ partnerId, commonInterests }) => {\r\n      console.log(\"Partner found:\", partnerId, commonInterests);\r\n      setPartnerId(partnerId);\r\n      setCommonInterests(commonInterests);\r\n      setSearching(false);\r\n      setVideoLoading(true);\r\n    });\r\n\r\n    socket.on(\"signal\", ({ signal }) => {\r\n      console.log(\"Signal received:\", signal);\r\n      if (peerRef.current) {\r\n        peerRef.current.signal(signal);\r\n      }\r\n    });\r\n\r\n    socket.on(\"partnerDisconnected\", () => {\r\n      console.log(\"Partner disconnected\");\r\n      if (skipDisconnectAlertRef.current) {\r\n        skipDisconnectAlertRef.current = false;\r\n      } else {\r\n        alert(\"Your chat partner has disconnected.\");\r\n      }\r\n      cleanupCall();\r\n      findPartner();\r\n    });\r\n\r\n    socket.on(\"receiveMessage\", (message) => {\r\n      console.log(\"Message received:\", message);\r\n      setMessages((prev) => [...prev, { sender: \"partner\", text: message }]);\r\n    });\r\n\r\n    // Listen for banned event.\r\n    socket.on(\"banned\", (msg) => {\r\n      alert(msg);\r\n    });\r\n\r\n    return () => {\r\n      socket.off(\"connect\");\r\n      socket.off(\"partnerFound\");\r\n      socket.off(\"signal\");\r\n      socket.off(\"partnerDisconnected\");\r\n      socket.off(\"receiveMessage\");\r\n      socket.off(\"banned\");\r\n    };\r\n  }, []);\r\n\r\n  // Start the call if partnerId is set and peer hasn't been created yet.\r\n  useEffect(() => {\r\n    if (partnerId && myId && !peerRef.current) {\r\n      const initiator = myId < partnerId;\r\n      console.log(\"Starting video chat. Initiator:\", initiator);\r\n      startVideoChat(initiator);\r\n    }\r\n  }, [partnerId, myId, cameraFacing]);\r\n\r\n  // Functions remain the same.\r\n  const findPartner = () => {\r\n    setSearching(true);\r\n    const interestList = interests.trim()\r\n      ? interests.split(\",\").map((i) => i.trim().toLowerCase())\r\n      : [];\r\n    console.log(\"Finding partner with interests:\", interestList);\r\n    socket.emit(\"findPartner\", interestList);\r\n  };\r\n\r\n  const startVideoChat = async (initiator) => {\r\n    try {\r\n      const localStream = stream\r\n        ? stream\r\n        : await navigator.mediaDevices.getUserMedia({\r\n            video: { facingMode: cameraFacing },\r\n            audio: {\r\n              echoCancellation: true,\r\n              noiseSuppression: true,\r\n              autoGainControl: true,\r\n              sampleRate: 48000,\r\n              channelCount: 2,\r\n            },\r\n          });\r\n      if (!stream) setStream(localStream);\r\n      if (userVideo.current) {\r\n        userVideo.current.srcObject = localStream;\r\n        userVideo.current.style.transform = \"scaleX(1)\";\r\n        userVideo.current.muted = true;\r\n      }\r\n      const peer = new SimplePeer({\r\n        initiator,\r\n        trickle: true,\r\n        stream: localStream,\r\n        config: {\r\n          iceServers: [\r\n            { urls: \"stun:stun.l.google.com:19302\" },\r\n            {\r\n              urls: \"turn:35.232.251.11:3478?transport=udp\",\r\n              username: \"mujib.rabin\",\r\n              credential: \"rabin\",\r\n            },\r\n            {\r\n              urls: \"turn:35.232.251.11:3478?transport=tcp\",\r\n              username: \"mujib.rabin\",\r\n              credential: \"rabin\",\r\n            },\r\n            {\r\n              urls: \"turns:35.232.251.11:5349\",\r\n              username: \"mujib.rabin\",\r\n              credential: \"rabin\",\r\n            },\r\n          ],\r\n        },\r\n      });\r\n      peer.on(\"signal\", (signal) => {\r\n        console.log(\"Sending signal:\", signal);\r\n        socket.emit(\"signal\", { partnerId, signal });\r\n      });\r\n      peer.on(\"stream\", (remoteStream) => {\r\n        console.log(\"Remote stream received. Audio tracks:\", remoteStream.getAudioTracks().length);\r\n        setPartnerStream(remoteStream);\r\n        if (partnerVideo.current) {\r\n          partnerVideo.current.srcObject = remoteStream;\r\n          partnerVideo.current.muted = false;\r\n          partnerVideo.current.volume = 1.0;\r\n          partnerVideo.current.onloadedmetadata = () => {\r\n            partnerVideo.current\r\n              .play()\r\n              .catch((err) => console.error(\"Error playing remote stream:\", err));\r\n            setVideoLoading(false);\r\n          };\r\n        }\r\n      });\r\n      peer.on(\"connect\", () => {\r\n        console.log(\"Peer connected!\");\r\n        const videoSender = peer._pc.getSenders().find((s) => s.track && s.track.kind === \"video\");\r\n        videoSenderRef.current = videoSender || null;\r\n      });\r\n      peer.on(\"error\", (err) => console.error(\"Peer error:\", err));\r\n      peer.on(\"iceStateChange\", (state) => console.log(\"ICE state:\", state));\r\n      peerRef.current = peer;\r\n    } catch (err) {\r\n      console.error(\"Error accessing media devices:\", err);\r\n    }\r\n  };\r\n\r\n  const replaceLocalTrack = async () => {\r\n    if (!peerRef.current) return;\r\n    const newStream = await navigator.mediaDevices.getUserMedia({\r\n      video: { facingMode: cameraFacing },\r\n      audio: false,\r\n    });\r\n    const newVideoTrack = newStream.getVideoTracks()[0];\r\n    if (videoSenderRef.current && newVideoTrack) {\r\n      await videoSenderRef.current.replaceTrack(newVideoTrack);\r\n      if (userVideo.current) {\r\n        userVideo.current.srcObject = newStream;\r\n        userVideo.current.style.transform = \"scaleX(1)\";\r\n        userVideo.current.muted = true;\r\n      }\r\n      if (stream) {\r\n        stream.getTracks().forEach((track) => track.stop());\r\n      }\r\n      setStream(newStream);\r\n    }\r\n  };\r\n\r\n  const cleanupCall = () => {\r\n    setPartnerId(null);\r\n    setCommonInterests([]);\r\n    setPartnerStream(null);\r\n    setMessages([]);\r\n    setNewMessage(\"\");\r\n    if (peerRef.current) {\r\n      peerRef.current.destroy();\r\n      peerRef.current = null;\r\n    }\r\n    videoSenderRef.current = null;\r\n    if (stream) {\r\n      stream.getTracks().forEach((track) => track.stop());\r\n    }\r\n    setStream(null);\r\n  };\r\n\r\n  const sendMessage = () => {\r\n    if (newMessage.trim() === \"\") return;\r\n    socket.emit(\"sendMessage\", newMessage);\r\n    setMessages((prev) => [...prev, { sender: \"you\", text: newMessage }]);\r\n    setNewMessage(\"\");\r\n  };\r\n\r\n  const nextPartner = () => {\r\n    skipDisconnectAlertRef.current = true;\r\n    cleanupCall();\r\n    socket.emit(\"nextPartner\");\r\n    findPartner();\r\n  };\r\n\r\n  const toggleCamera = async () => {\r\n    const newFacing = cameraFacing === \"user\" ? \"environment\" : \"user\";\r\n    setCameraFacing(newFacing);\r\n    if (peerRef.current) {\r\n      await replaceLocalTrack();\r\n    } else {\r\n      if (stream) {\r\n        stream.getTracks().forEach((track) => track.stop());\r\n      }\r\n      await startVideoChat(true);\r\n    }\r\n  };\r\n\r\n  // Render conditionally based on authentication.\r\n  if (!user) {\r\n    return <SignIn onSignIn={handleSignIn} />;\r\n  }\r\n\r\n  // Otherwise, render the main app.\r\n  return (\r\n    <div className={`app-wrapper ${partnerId ? \"video-active\" : \"no-partner\"}`}>\r\n      {/* Sidebar */}\r\n      <div className=\"sidebar\">\r\n        <div className=\"branding\">\r\n          <h2>TALKVEE</h2>\r\n          <p>Connect based on interests</p>\r\n        </div>\r\n        <div className=\"sidebar-content\">\r\n          {!partnerId && (\r\n            <div className=\"partner-search\">\r\n              <input\r\n                type=\"text\"\r\n                value={interests}\r\n                onChange={(e) => setInterests(e.target.value)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === \"Enter\") {\r\n                    findPartner();\r\n                  }\r\n                }}\r\n                placeholder=\"Enter interests (optional)\"\r\n                className=\"form-control\"\r\n              />\r\n              <button onClick={findPartner} disabled={searching} className=\"btn btn-primary mt-3\">\r\n                {searching ? \"Searching...\" : \"Find a Partner\"}\r\n              </button>\r\n            </div>\r\n          )}\r\n          {partnerId && (\r\n            <div className=\"chat-box\">\r\n              <div className=\"chat-messages\">\r\n                {messages.map((msg, index) => (\r\n                  <div key={index} className={`chat-message ${msg.sender === \"you\" ? \"sent\" : \"received\"}`}>\r\n                    {msg.text}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              <div className=\"chat-input\">\r\n                <input\r\n                  type=\"text\"\r\n                  value={newMessage}\r\n                  onChange={(e) => setNewMessage(e.target.value)}\r\n                  onKeyDown={(e) => {\r\n                    if (e.key === \"Enter\") {\r\n                      sendMessage();\r\n                    }\r\n                  }}\r\n                  placeholder=\"Type a message...\"\r\n                />\r\n                <button onClick={sendMessage} className=\"btn btn-outline-light\">\r\n                  Send\r\n                </button>\r\n              </div>\r\n              {/* Report Partner button */}\r\n              <div style={{ marginTop: \"10px\" }}>\r\n                <button\r\n                  onClick={() => {\r\n                    if (window.confirm(\"Are you sure you want to report this user?\")) {\r\n                      socket.emit(\"reportUser\", { reportedSocketId: partnerId });\r\n                    }\r\n                  }}\r\n                  className=\"btn btn-danger\"\r\n                >\r\n                  Report Partner\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n      {/* Main content */}\r\n      <div className=\"main-content\">\r\n        {partnerId ? (\r\n          <>\r\n            <div className=\"video-container\">\r\n              {videoLoading && (\r\n                <div className=\"loading-overlay\">\r\n                  <div className=\"loader\">\r\n                    <div></div>\r\n                    <div></div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <video ref={partnerVideo} autoPlay playsInline className=\"partner-video\" />\r\n              <video ref={userVideo} autoPlay playsInline className=\"user-video-overlay\" />\r\n            </div>\r\n            <div className=\"common-interests\">\r\n              <h4>Common Interests:</h4>\r\n              <p>{commonInterests.length > 0 ? commonInterests.join(\", \") : \"None\"}</p>\r\n            </div>\r\n            <div className=\"control-buttons-bottom\">\r\n              <button onClick={() => window.location.reload()} className=\"btn btn-danger btn-lg\">\r\n                Disconnect\r\n              </button>\r\n              <button onClick={nextPartner} className=\"btn btn-warning btn-lg\">\r\n                Next\r\n              </button>\r\n            </div>\r\n            <button className=\"switch-camera\" onClick={toggleCamera}>\r\n              &#8635;\r\n            </button>\r\n            <button className=\"chat-toggle\" onClick={() => setShowChat((prev) => !prev)}>\r\n              {showChat ? \"Hide Chat\" : \"Show Chat\"}\r\n            </button>\r\n            <div className={`chat-overlay ${showChat ? \"active\" : \"\"}`}>\r\n              <div className=\"chat-messages\">\r\n                {messages.map((msg, index) => (\r\n                  <div key={index} className={`chat-message ${msg.sender === \"you\" ? \"sent\" : \"received\"}`}>\r\n                    {msg.text}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              <div className=\"chat-input\">\r\n                <input\r\n                  type=\"text\"\r\n                  value={newMessage}\r\n                  onChange={(e) => setNewMessage(e.target.value)}\r\n                  onKeyDown={(e) => {\r\n                    if (e.key === \"Enter\") {\r\n                      sendMessage();\r\n                    }\r\n                  }}\r\n                  placeholder=\"Type a message...\"\r\n                />\r\n                <button onClick={sendMessage}>Send</button>\r\n              </div>\r\n            </div>\r\n          </>\r\n        ) : (\r\n          <div className=\"welcome-message\">\r\n            <h3>Welcome to TALKVEE</h3>\r\n            <p>MAY CONTAIN WEIRD BUT FUN PEOPLE.</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}